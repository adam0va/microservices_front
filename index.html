<!DOCTYPE html>
<html>
<head>
	<title>basic title</title>
	<meta charset="utf-8">
	<script
			  src="https://code.jquery.com/jquery-3.4.1.min.js"
			  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
			  crossorigin="anonymous">
	</script>
</head>
<body>
	<div class="container">
		<div class="title_wrap">
		</div>
		<div class="content_wrap">
			<div class="content_title">
			</div>
			<div class="content">
			</div>
			<div class="form_wrap">
			</div>
		</div>
	</div>
</body>

<style type="text/css">

	body {
		box-sizing: border-box;
	}
	.container {
		max-width: 1000px;
		margin: auto;
	}
	.title_wrap {
		display: flex;
		justify-content: space-around;
		text-align: center;
		vertical-align: center;
	}
	.title {
		cursor: pointer;
		color: grey;
	}
	.title:hover {
		color: #FF6E9E;
	}
	.title_active {
		color: #FF6E9E;
	}
	.form_wrap {
		display: flex;
		justify-content: space-around;
		text-align: center;
		vertical-align: center;
		width: 60%;
		margin: auto;
		margin-top: 10px;
		margin-bottom: 10px;
	}
	.content_title {
		display: flex;
		flex-direction: row;
		justify-content: space-around;
		align-items: center;
		height: 50px;
		border: 2px dotted pink;
		text-transform: uppercase;
	}
	.content_element {
		display: flex;
		flex-direction: row;
		justify-content: space-around;
		align-items: center;
		height: 50px;
		background-color: #FFF0F5;
		box-shadow: 0 0 3px rgba(0,0,0,0.1);
		margin-top: 10px;
		cursor: pointer;
	}
	.content_element:hover {
		background-color: #FCDEE8;
	}
	.content_element_alone {
		display: flex;
		flex-direction: row;
		justify-content: space-around;
		align-items: center;
		height: 50px;
		background-color: #FFF0F5;
		box-shadow: 0 0 3px rgba(0,0,0,0.2);
		margin-top: 10px;
	}
	.content_element_alone:hover {
		background-color: #FCDEE8;
	}
	.content_element_passive {
		float: left;
		color: grey;
		text-align: center;
		vertical-align: center;
		margin: auto;
	}
	.content_element_button_delete_readers, .content_element_button_delete_books, .content_element_button_delete_authors {
		display: inline-block;
		height: 30px;
		width: 30px;
		border-radius: 3px;
		width: 2%;
		text-align: center;
		vertical-align: center;
		background-color: #fd380e;
		cursor: pointer;
		color: white;
	}
	.bookdetails {
		display: flex;
		flex-direction: row;
		justify-content: space-around;
		align-items: center;
	}
	button {
		cursor: pointer;
	}
</style>



<script type="text/javascript">

	function clearItem(arg) {
		$(arg).empty();
	}
	function makeTitle () { 
		$("<h1/>", {
			"id": "readers",
			"class": "title"
		}).text("READERS").appendTo(".title_wrap");
		$("<h1/>", {
			"id": "books",
			"class": "title"
		}).text("BOOKS").appendTo(".title_wrap");
		$("<h1/>", {
			"id": "authors",
			"class": "title"
		}).text("AUTHORS").appendTo(".title_wrap");
	}


	function makeReadersTitle () {
		$("<div/>").text("name").appendTo(".content_title");
		$("<div/>").text("surname").appendTo(".content_title");
		$("<div/>").text("date of birth").appendTo(".content_title");
		$("<div/>").text("uuid").appendTo(".content_title");
	};
	function makeAuthorsTitle () {
		$("<div/>").text("name").appendTo(".content_title");
		$("<div/>").text("surname").appendTo(".content_title");
		$("<div/>").text("date of birth").appendTo(".content_title");
		$("<div/>").text("country").appendTo(".content_title");
		$("<div/>").text("uuid").appendTo(".content_title");
	};
	function makeBooksTitle () {
		$("<div/>").text("title").appendTo(".content_title");
		$("<div/>").text("author name").appendTo(".content_title");
		$("<div/>").text("author surname").appendTo(".content_title");
		$("<div/>").text("book uuid").appendTo(".content_title");
		$("<div/>").text("status").appendTo(".content_title");
	};


	function readersLoad () {
		clearItem(".title_wrap")
		clearItem(".content_title")
		clearItem(".content");
		clearItem(".form_wrap");
		$( ".bookdetails" ).remove();
		makeTitle();
		makeReadersTitle();
		$.get('http://127.0.0.1:8000/readers/', function(data) {
	  		console.log("loaded readers" + data);
	  		$.each(data, function(key, val) {
	  			var items = [];
	  			items.push("<div id='" + key +"'>" + val.name + "</div>");
	  			items.push("<div id='" + key +"'>" + val.surname + "</div>");
	  			items.push("<div id='" + key +"'>" + val.date_of_birth + "</div>");
	  			items.push("<div id='uuidclass'>" + val.uuid + "</div>");	
		  		$("<div/>", {
		  			"class": "content_element",
		  			"id": "element_reader",
		  			html: items.join("")
		  		}).appendTo(".content");
		  	});
	  	});
	  	makePostFormReaders();
	}
	function authorsLoad () {
		clearItem(".title_wrap")
		clearItem(".content_title")
		clearItem(".content");
		clearItem(".form_wrap");
		$( ".bookdetails" ).remove();
		makeTitle();
		makeAuthorsTitle();
		$.get('http://127.0.0.1:8000/authors/', function(data) {
	  		console.log("loaded authors" + data);
	  		$.each(data, function(key, val) {
	  			var items = [];
	  			items.push("<div id='" + key +"'>" + val.name + "</div>");
	  			items.push("<div id='" + key +"'>" + val.surname + "</div>");
	  			items.push("<div id='" + key +"'>" + val.date_of_birth + "</div>");
	  			items.push("<div id='" + key +"'>" + val.country + "</div>");
	  			items.push("<div id='uuidclass'>" + val.uuid + "</div>");		
		  		$("<div/>", {
		  			"class": "content_element",
		  			"id": "element_authors",
		  			html: items.join("")
		  		}).appendTo(".content");
		  	});
	  	});
	  	makePostFormAuthors();
	}
	function booksLoad () {
		clearItem(".title_wrap")
		clearItem(".content_title")
		clearItem(".content");
		clearItem(".form_wrap");
		$( ".bookdetails" ).remove();
		makeTitle();
		makeBooksTitle();
		$.get('http://127.0.0.1:8000/books/', function(data) {
	  		console.log("loaded books" + data);
	  		$.each(data, function(key, val) {
	  			var items = [];
  				items.push("<div id='" + key +"'>" + val.title + "</div>");
  				console.log(typeof(val.author_uuid) + val.author_uuid);
  				if (val.author_uuid == null) {
		  			items.push("<div id='" + key +"'>" + "---" + "</div>");
		  			items.push("<div id='" + key +"'>" + "---" + "</div>");
  				} else {
		  			items.push("<div id='" + key +"'>" + val.author.name + "</div>");
		  			items.push("<div id='" + key +"'>" + val.author.surname + "</div>");
  				}
	  			items.push("<div id='uuidclass'>" + val.uuid + "</div>");
	  			items.push("<div id='" + key +"'>" + val.title + "</div>");
		  		$("<div/>", {
		  			"class": "content_element",
		  			"id": "element_books",
		  			html: items.join(""),
		  		}).appendTo(".content");
		  	});
	  	});
	  	makePostFormBooks();
	}


	function uuidreadersLoad (tracker) {
		clearItem(".content");
		clearItem(".form_wrap");
		$.get('http://127.0.0.1:8000/readers/' + tracker, function(data) {
	  		console.log("uuid data - " + data + "tracker - " + tracker);
  			var items = [];
  			items.push("<div>" + data.name + "</div>");
  			items.push("<div>" + data.surname + "</div>");
  			items.push("<div>" + data.date_of_birth + "</div>");
  			items.push("<div id='uuidclass'>" + data.uuid + "</div>");	
	  		$("<div/>", {
	  			"class": "content_element_alone",
	  			html: items.join("")
	  		}).appendTo(".content");
	  		$("<div/>", {
	  			"class": "content_element_button_delete_readers",
	  		}).text("del").appendTo(".content_element_alone");
	  	});
	  	makePatchFormReaders();		
	}
	function uuidauthorsLoad (tracker) {
		clearItem(".content");
		clearItem(".form_wrap");
		$.get('http://127.0.0.1:8000/authors/' + tracker, function(data) {
	  		console.log("uuid data - " + data + "tracker - " + tracker);
  			var items = [];
	  			items.push("<div>" + data.name + "</div>");
	  			items.push("<div>" + data.surname + "</div>");
	  			items.push("<div>" + data.date_of_birth + "</div>");
	  			items.push("<div>" + data.country + "</div>");
	  			items.push("<div id='uuidclass'>" + data.uuid + "</div>");		
	  		$("<div/>", {
	  			"class": "content_element_alone",
	  			html: items.join("")
	  		}).appendTo(".content");
	  		$("<div/>", {
	  			"class": "content_element_button_delete_authors",
	  		}).text("del").appendTo(".content_element_alone");
	  	});
	  	makePatchFormAuthors();		
	}
	function uuidbooksLoad (tracker) {
		clearItem(".content");
		clearItem(".form_wrap");
		$.get('http://127.0.0.1:8000/books/' + tracker, function(data) {
  			var items = [];
			items.push("<div>" + data.title + "</div>");
			items.push("<div id='uuidclass'>" + data.uuid + "</div>");
			items.push("<div>" + data.title + "</div>");
	  		$("<div/>", {
	  			"class": "content_element_alone",
	  			html: items.join("")
	  		}).appendTo(".content");
	  		$("<div/>", {
	  			"class": "content_element_button_delete_books"
	  		}).text("del").appendTo(".content_element_alone");
	  		var subitems = [];
	  		$("<div/>", {
	  			"class": "bookdetails",
	  		}).appendTo(".content_wrap");
	  		if (data.author_uuid == null) {
	  			subitems.push("<h1>AUTHOR</h1>");
	  			subitems.push("<div>" + "---" + "</div>");
	  			subitems.push("<div>" + "---" + "</div>");
	  			subitems.push("<div>" + "---" + "</div>");
	  		} else {
	  			subitems.push("<h1>AUTHOR</h1>");
	  			subitems.push("<div>" + data.author.name + "</div>");
	  			subitems.push("<div>" + data.author.surname + "</div>");
	  			subitems.push("<div>" + data.author_uuid + "</div>");
	  		}
	  		$("<div/>", {
	  			"class": "content_element_alone_passive",
	  			html: subitems.join("")
	  		}).appendTo(".bookdetails");
	  		var subitemssmall = [];
	  		if (data.reader_uuid == null) {
	  			subitemssmall.push("<h1>READER</h1>");
	  			subitemssmall.push("<div>" + "---" + "</div>");
	  			subitemssmall.push("<div>" + "---" + "</div>");
	  			subitemssmall.push("<div>" + "---" + "</div>");
	  		} else {
	  			subitemssmall.push("<h1>READER</h1>");
	  			subitemssmall.push("<div>" + data.reader.name + "</div>");
	  			subitemssmall.push("<div>" + data.reader.surname + "</div>");
	  			subitemssmall.push("<div>" + data.reader_uuid + "</div>");
	  		}
	  		$("<div/>", {
	  			"class": "content_element_alone_passive",
	  			html: subitemssmall.join("")
	  		}).appendTo(".bookdetails");
	  	});
	  	makePatchFormBooks();		
	}


	function makePatchFormReaders () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "patch_form",
			"action": "",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "name",
			"onfocus": "this.value=''",
			"value": "user name"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "surname",
			"onfocus": "this.value=''",
			"value": "user surname"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "date_of_birth",
			"onfocus": "this.value=''",
			"value": "user birth date"
		}).appendTo("#patch_form");
		$("<button/>", {
			"id": "submit_patch_readers",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("edit").appendTo("#patch_form");
	}
	function makePatchFormBooks () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "patch_form",
			"action": "",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "title",
			"onfocus": "this.value=''",
			"value": "title"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "author_uuid",
			"onfocus": "this.value=''",
			"value": "author uuid"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "reader_uuid",
			"onfocus": "this.value=''",
			"value": "reader uuid"
		}).appendTo("#patch_form");
		$("<button/>", {
			"id": "submit_patch_books",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("edit").appendTo("#patch_form");
	}
	function makePatchFormAuthors () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "patch_form",
			"action": "",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "name",
			"onfocus": "this.value=''",
			"value": "user name"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "surname",
			"onfocus": "this.value=''",
			"value": "user surname"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "date_of_birth",
			"onfocus": "this.value=''",
			"value": "user birth date"
		}).appendTo("#patch_form");
		$("<input/>", {
			"type": "text",
			"name": "country",
			"onfocus": "this.value=''",
			"value": "author country"
		}).appendTo("#patch_form");
		$("<button/>", {
			"id": "submit_patch_authors",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("edit").appendTo("#patch_form");
	}


	function makePostFormReaders () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "post_form",
			"action": "POST",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "name",
			"onfocus": "this.value=''",
			"value": "user name"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "surname",
			"onfocus": "this.value=''",
			"value": "user surname"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "date_of_birth",
			"onfocus": "this.value=''",
			"value": "user birth date"
		}).appendTo("#post_form");
		$("<button/>", {
			"id": "submit_post_readers",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("add user").appendTo("#post_form");
	}
	function makePostFormBooks () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "post_form",
			"action": "POST",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "title",
			"onfocus": "this.value=''",
			"value": "title"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "author_uuid",
			"onfocus": "this.value=''",
			"value": "author uuid"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "reader_uuid",
			"onfocus": "this.value=''",
			"value": "reader uuid"
		}).appendTo("#post_form");
		$("<button/>", {
			"id": "submit_post_books",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("add book").appendTo("#post_form");
	}
	function makePostFormAuthors () {
		clearItem("#form_wrap");
		$("<form/>", {
			"id": "post_form",
			"action": "POST",
			"method": ""
		}).appendTo(".form_wrap");
		$("<input/>", {
			"type": "text",
			"name": "name",
			"onfocus": "this.value=''",
			"value": "author name"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "surname",
			"onfocus": "this.value=''",
			"value": "author surname"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "date_of_birth",
			"onfocus": "this.value=''",
			"value": "author birth date"
		}).appendTo("#post_form");
		$("<input/>", {
			"type": "text",
			"name": "country",
			"onfocus": "this.value=''",
			"value": "author country"
		}).appendTo("#post_form");
		$("<button/>", {
			"id": "submit_post_authors",
			"type": "button",
			"name": "submit",
			"value": "submit"
		}).text("add author").appendTo("#post_form");
	}


	function patchReaders (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/readers/' + idtracker + '/',
			method: "PATCH",
			dataType: 'json',
			data: $("#patch_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function patchBooks (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/books/' + idtracker + '/',
			method: "PATCH",
			dataType: 'json',
			data: $("#patch_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function patchAuthors (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/authors/' + idtracker + '/',
			method: "PATCH",
			dataType: 'json',
			data: $("#patch_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}


	function submitReaders () {
		$.ajax({
			url: 'http://127.0.0.1:8000/readers/',
			method: "POST",
			dataType: 'json',
			data: $("#post_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function submitAuthors () {
		$.ajax({
			url: 'http://127.0.0.1:8000/authors/',
			method: "POST",
			dataType: 'json',
			data: $("#post_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function submitBooks () {
		$.ajax({
			url: 'http://127.0.0.1:8000/books/',
			method: "POST",
			dataType: 'json',
			data: $("#post_form").serialize(),
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}


	function deleteReaders (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/readers/' + idtracker +'/',
			method: "DELETE",
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function deleteAuthors (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/authors/' + idtracker +'/',
			method: "DELETE",
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	function deleteBooks (idtracker) {
		$.ajax({
			url: 'http://127.0.0.1:8000/books/' + idtracker +'/',
			method: "DELETE",
			success: function(result) {
				console.log(result + "addet");
			},
			error: function(xhr, resp, text) {
				console.log(xhr, resp, text);
			}
		});
	}
	/* event handlers */

	$(document).on('click','#element_reader', function() {
		var uuidAlone = $(this).find("#uuidclass").text();
		uuidreadersLoad(uuidAlone);
	});
	$(document).on('click','#element_authors', function() {
		var uuidAlone = $(this).find("#uuidclass").text();
		uuidauthorsLoad(uuidAlone);
	});
	$(document).on('click','#element_books', function() {
		var uuidAlone = $(this).find("#uuidclass").text();
		uuidbooksLoad(uuidAlone);
	});



	$(document).on('click', '#submit_post_readers', function() {
		submitReaders();
		readersLoad();
	});
	$(document).on('click', '#submit_post_authors', function() {
		submitAuthors();
		authorsLoad();
	});
	$(document).on('click', '#submit_post_books', function() {
		submitBooks();
		booksLoad();
	});


	$(document).on('click','#submit_patch_readers', function() {
		var uuidAlone = $(".content_element_alone").find("#uuidclass").text();
		patchReaders(uuidAlone);
		clearItem(".content_element_alone");
		uuidreadersLoad(uuidAlone);
	});
	$(document).on('click','#submit_patch_books', function() {
		var uuidAlone = $(".content_element_alone").find("#uuidclass").text();
		patchBooks(uuidAlone);
		clearItem(".content_element_alone");
		uuidbooksLoad(uuidAlone);
	});
	$(document).on('click','#submit_patch_authors', function() {
		var uuidAlone = $(".content_element_alone").find("#uuidclass").text();
		patchAuthors(uuidAlone);
		clearItem(".content_element_alone");
		uuidauthorsLoad(uuidAlone);
	});


	$(document).on('click', '.content_element_button_delete_readers', function() {
		var uuidBye = $(".content_element_alone").find("#uuidclass").text();
		deleteReaders(uuidBye);
		readersLoad();
	});
	$(document).on('click', '.content_element_button_delete_authors', function() {
		var uuidBye = $(".content_element_alone").find("#uuidclass").text();
		deleteAuthors(uuidBye);
		authorsLoad();
	});
	$(document).on('click', '.content_element_button_delete_books', function() {
		var uuidBye = $(".content_element_alone").find("#uuidclass").text();
		deleteBooks(uuidBye);
		booksLoad();
	});


	$(document).on('click', '#readers', function() {
		readersLoad();
		$("#readers").addClass("title_active");
		$("#authors").removeClass("title_active");
		$("#books").removeClass("title_active");
	});
	$(document).on('click', '#authors', function() {
		authorsLoad();
		$("#readers").removeClass("title_active");
		$("#authors").addClass("title_active");
		$("#books").removeClass("title_active");
	});
	$(document).on('click', '#books', function() {
		booksLoad();
		$("#readers").removeClass("title_active");
		$("#authors").removeClass("title_active");
		$("#books").addClass("title_active");
	});

	/* page ready func */

	$(document).ready(function() {
		makeTitle();
	});


</script>


</html>









